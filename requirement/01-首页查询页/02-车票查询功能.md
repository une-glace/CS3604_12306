# 1.2 车票查询功能需求

## 1.2.1 首页发起查询校验
**Scenario: 用户未在车票查询表单中输入出发地**
- Given 用户在**首页/查询页**且未在车票查询表单中输入出发地
- When 用户在车票查询表单中点击**查询**
- Then 查询按钮上方出现系统提示"请选择出发城市"，文字颜色#d32f2f（红色），字体大小13px，内边距10px 0px，背景#ffebee（浅红色），居中对齐

**Scenario: 用户未在车票查询表单中输入到达地**
- Given 用户在**首页/查询页**且未在车票查询表单中输入到达地
- When 用户在车票查询表单中点击**查询**
- Then 查询按钮上方出现系统提示"请选择到达城市"，文字颜色#d32f2f（红色），字体大小13px，内边距10px 0px，背景#ffebee（浅红色），居中对齐

**Scenario: 用户在车票查询表单中输入的出发地不在12306支持的城市列表中**
- Given 用户在**首页/查询页**的车票查询表单中输入了一个不在**数据库**的城市作为出发地或到达地
- When 用户在车票查询表单中点击**查询**
- Then 查询按钮上方出现系统提示"无法匹配该出发城市"或"无法匹配该到达城市"，文字颜色#d32f2f（红色），字体大小13px，内边距10px 0px，背景#ffebee（浅红色），居中对齐

**Scenario: 用户成功查询**
- Given 用户在**首页/查询页**的车票查询表单中输入了正确的出发地、到达地、出发日期
- When 用户点击“**查询**”按钮
- And  系统成功响应
- Then 系统跳转至车次列表页，URL携带 `from`, `to`, `date` 参数，并自动执行查询

## 1.2.2 列表页二次查询栏功能
**位置**：车次列表页顶部（蓝色导航栏下方）。
**功能**：
- **单程/往返切换**：支持切换行程类型（当前主要支持单程）。
- **出发/到达地修改**：
  - 显示当前查询的出发地和到达地。
  - 支持点击输入框修改，支持模糊搜索和拼音首字母匹配。
  - 支持点击“互换”按钮交换出发/到达地。
- **日期选择**：
  - **出发日期**：显示当前查询日期，点击弹出日历选择器。
  - **返程日期**：单程模式下禁用（灰色），往返模式下激活。
- **票种切换**：
  - **普通**（默认）：查询成人/儿童票。
  - **学生**：勾选后查询学生票（需后端支持学生票优惠逻辑）。
- **查询操作**：点击“查询”按钮，更新URL参数并刷新下方列表数据。

## 1.2.3 日期导航与筛选功能
**日期导航条**：
- 显示当前查询日期及其前后各几天的日期选项。
- **交互**：点击某一日期，直接刷新列表数据至该日期，并更新查询栏中的出发日期。
- **样式**：当前选中日期高亮显示（蓝色背景，白字），其他日期为白色背景黑字。

**多维度筛选区域**：
- **车次类型**：复选框，支持多选。
  - 选项：全部、GC-高铁/城际、D-动车、Z-直达、T-特快、K-快速、其他、复兴号、智能动车组。
- **出发车站**：复选框，动态列出当前结果中包含的所有出发车站（如北京南、北京西）。
- **到达车站**：复选框，动态列出当前结果中包含的所有到达车站（如上海虹桥、上海）。
- **车次席别**：复选框，支持多选。
  - 选项：商务座、优选一等座、一等座、二等座、一等卧、二等卧、软卧、硬卧、硬座、无座等。
- **发车时间**：下拉选择框。
  - 选项：00:00-24:00（默认）、00:00-06:00、06:00-12:00、12:00-18:00、18:00-24:00。
- **筛选逻辑**：前端实时过滤。选中条件后，下方列表即时更新，无需点击额外按钮（虽然UI可能有“筛选”按钮作为折叠开关或确认）。

## 1.2.4 查询结果列表展示
**列表表头**：
- **车次**：显示车次号，支持点击排序（升/降序）。
- **出发站/到达站**：显示车站名称。
- **出发时间/到达时间**：显示HH:mm格式时间，支持点击排序（最早/最晚）。
- **历时**：显示运行总时长（如 4:28），支持点击排序（最短/最长）。
- **席别余票**：横向列出所有席别（商务座、一等座、二等座...）。
  - **有**：余票充足（绿色或黑色）。
  - **数字**：显示具体剩余张数（如 "5张"）。
  - **无**：无票（灰色或"--"）。
  - **候补**：无票但可候补（橙色/蓝色文字）。
- **备注**：显示“预订”按钮或其他状态信息。

**列表内容行**：
- **车次信息**：
  - 车次号（如 G1），点击可查看经停站信息（悬浮/弹窗）。
  - 始/终图标：标识该车次是否为始发车或终到车。
- **时间信息**：
  - 出发时间（大号字体）。
  - 到达时间（大号字体），若跨天显示“次日”或“+1”。
  - 当日到达标识。
- **操作按钮**：
  - **预订**：蓝色按钮，点击进入订单填写页。
  - **候补**：橙色按钮（若无票且支持候补）。
  - **不可预订**：灰色按钮（如列车已发车或未开售）。

## 1.2.5 预订交互流程
**Scenario: 用户点击预订按钮**
- Given 用户在车次列表页点击某车次的“预订”按钮
- Check 用户登录状态
  - If **未登录**: 弹出登录模态框 -> 登录成功 -> 自动跳转至订单填写页。
  - If **已登录**: 直接跳转至订单填写页。
- Data 传递至订单页的数据：
  - 车次号、出发/到达站、日期、时间、历时、默认席别及价格信息。
